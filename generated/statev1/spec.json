{
  "swagger": "2.0",
  "info": {
    "title": "State V1 API",
    "version": "V1"
  },
  "tags": [
    {
      "name": "StateV1"
    }
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/v1/state/metric-usages-by-label-name": {
      "get": {
        "operationId": "ListMetricUsagesByLabelName",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/statev1ListMetricUsagesByLabelNameResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "page.max_size",
            "description": "Sets the preferred number of items to return per page. If set to `0`, the\nserver will use its default value. Regardless of the value specified, clients\nmust never assume how many items will be returned.",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "page.token",
            "description": "An opaque page token that identifies which page the client should request.\nAn empty value indicates the first page.",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "order.ascending",
            "in": "query",
            "required": false,
            "type": "boolean"
          },
          {
            "name": "order.by",
            "in": "query",
            "required": false,
            "type": "string",
            "enum": [
              "VALUABLE",
              "DPPS",
              "UTILITY",
              "REFERENCES",
              "EXECUTIONS",
              "UNIQUE_VALUES",
              "UNIQUE_USERS"
            ]
          },
          {
            "name": "lookback_secs",
            "description": "Controls the time range over which query executions are included in usages. Defaults to `2592000` (30 days).",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "label_name_glob",
            "description": "Glob match string for filtering results by label name.",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "include_counts_by_type",
            "description": "If `true`, responses include the fields `reference_counts_by_type` and `query_execution_counts_by_type`. If `false`, these fields are returned empty.",
            "in": "query",
            "required": false,
            "type": "boolean"
          }
        ],
        "tags": [
          "StateV1"
        ]
      }
    },
    "/v1/state/metric-usages-by-metric-name": {
      "get": {
        "operationId": "ListMetricUsagesByMetricName",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/statev1ListMetricUsagesByMetricNameResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "page.max_size",
            "description": "Sets the preferred number of items to return per page. If set to `0`, the\nserver will use its default value. Regardless of the value specified, clients\nmust never assume how many items will be returned.",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "page.token",
            "description": "An opaque page token that identifies which page the client should request.\nAn empty value indicates the first page.",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "order.ascending",
            "in": "query",
            "required": false,
            "type": "boolean"
          },
          {
            "name": "order.by",
            "in": "query",
            "required": false,
            "type": "string",
            "enum": [
              "VALUABLE",
              "DPPS",
              "UTILITY",
              "REFERENCES",
              "EXECUTIONS",
              "UNIQUE_VALUES",
              "UNIQUE_USERS"
            ]
          },
          {
            "name": "lookback_secs",
            "description": "Controls the time range over which query executions are included in usages. Defaults to `2592000` (30 days).",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "metric_name_glob",
            "description": "Glob match string for filtering results by metric name.",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "include_counts_by_type",
            "description": "If `true`, responses include the fields `reference_counts_by_type` and `query_execution_counts_by_type`. If `false`, these fields are returned empty.",
            "in": "query",
            "required": false,
            "type": "boolean"
          }
        ],
        "tags": [
          "StateV1"
        ]
      }
    },
    "/v1/state/rule-evaluations": {
      "get": {
        "operationId": "ListRuleEvaluations",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/statev1ListRuleEvaluationsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "page.max_size",
            "description": "Sets the preferred number of items to return per page. If set to `0`, the\nserver will use its default value. Regardless of the value specified, clients\nmust never assume how many items will be returned.",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "page.token",
            "description": "An opaque page token that identifies which page the client should request.\nAn empty value indicates the first page.",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "StateV1"
        ]
      }
    }
  },
  "definitions": {
    "MetricUsageOrderBy": {
      "type": "string",
      "enum": [
        "VALUABLE",
        "DPPS",
        "UTILITY",
        "REFERENCES",
        "EXECUTIONS",
        "UNIQUE_VALUES",
        "UNIQUE_USERS"
      ]
    },
    "MetricUsageQueryExecutionCountsByType": {
      "type": "object",
      "properties": {
        "explorer": {
          "type": "integer",
          "format": "int32"
        },
        "dashboard": {
          "type": "integer",
          "format": "int32"
        },
        "external": {
          "type": "integer",
          "format": "int32"
        }
      }
    },
    "MetricUsageReferenceCountsByType": {
      "type": "object",
      "properties": {
        "dashboards": {
          "type": "integer",
          "format": "int32"
        },
        "monitors": {
          "type": "integer",
          "format": "int32"
        },
        "recording_rules": {
          "type": "integer",
          "format": "int32"
        },
        "drop_rules": {
          "type": "integer",
          "format": "int32"
        },
        "aggregation_rules": {
          "type": "integer",
          "format": "int32"
        }
      }
    },
    "RuleEvaluationRuleType": {
      "type": "string",
      "enum": [
        "MONITOR",
        "RECORDING"
      ]
    },
    "configv1PageParams": {
      "type": "object",
      "properties": {
        "max_size": {
          "type": "integer",
          "format": "int64",
          "description": "Sets the preferred number of items to return per page. If set to `0`, the\nserver will use its default value. Regardless of the value specified, clients\nmust never assume how many items will be returned."
        },
        "token": {
          "type": "string",
          "description": "An opaque page token that identifies which page the client should request.\nAn empty value indicates the first page."
        }
      }
    },
    "configv1PageResult": {
      "type": "object",
      "properties": {
        "next_token": {
          "type": "string",
          "description": "An opaque page token that identifies the next page of items that the\nclient should request. An empty value indicates that there are no\nmore items to return."
        }
      }
    },
    "protobufAny": {
      "type": "object",
      "properties": {
        "@type": {
          "type": "string"
        }
      },
      "additionalProperties": {}
    },
    "rpcStatus": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32"
        },
        "message": {
          "type": "string"
        },
        "details": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/protobufAny"
          }
        }
      }
    },
    "statev1ListMetricUsagesByLabelNameResponse": {
      "type": "object",
      "properties": {
        "page": {
          "$ref": "#/definitions/configv1PageResult"
        },
        "usages": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/statev1MetricUsageByLabelName"
          }
        }
      }
    },
    "statev1ListMetricUsagesByMetricNameResponse": {
      "type": "object",
      "properties": {
        "page": {
          "$ref": "#/definitions/configv1PageResult"
        },
        "usages": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/statev1MetricUsageByMetricName"
          }
        }
      }
    },
    "statev1ListRuleEvaluationsResponse": {
      "type": "object",
      "properties": {
        "page": {
          "$ref": "#/definitions/configv1PageResult"
        },
        "rule_evaluations": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/statev1RuleEvaluation"
          }
        }
      }
    },
    "statev1MetricUsage": {
      "type": "object",
      "properties": {
        "total_references": {
          "type": "integer",
          "format": "int32"
        },
        "total_query_executions": {
          "type": "integer",
          "format": "int32"
        },
        "total_unique_users": {
          "type": "integer",
          "format": "int32"
        },
        "utility_score": {
          "type": "number",
          "format": "double"
        },
        "reference_counts_by_type": {
          "$ref": "#/definitions/MetricUsageReferenceCountsByType"
        },
        "query_execution_counts_by_type": {
          "$ref": "#/definitions/MetricUsageQueryExecutionCountsByType"
        }
      }
    },
    "statev1MetricUsageByLabelName": {
      "type": "object",
      "properties": {
        "label_name": {
          "type": "string"
        },
        "usage": {
          "$ref": "#/definitions/statev1MetricUsage"
        },
        "total_unique_values": {
          "type": "integer",
          "format": "int32"
        },
        "dpps": {
          "type": "number",
          "format": "double"
        },
        "percent_of_series_with_label_name": {
          "type": "number",
          "format": "double",
          "title": "Percent of persisted series observed to have the label name.\nReturns in format: [0.0, 100.0]"
        }
      }
    },
    "statev1MetricUsageByMetricName": {
      "type": "object",
      "properties": {
        "metric_name": {
          "type": "string"
        },
        "usage": {
          "$ref": "#/definitions/statev1MetricUsage"
        },
        "dpps": {
          "type": "number",
          "format": "double"
        }
      }
    },
    "statev1MetricUsageOrder": {
      "type": "object",
      "properties": {
        "ascending": {
          "type": "boolean"
        },
        "by": {
          "$ref": "#/definitions/MetricUsageOrderBy"
        }
      }
    },
    "statev1RuleEvaluation": {
      "type": "object",
      "properties": {
        "rule_slug": {
          "type": "string",
          "description": "Unique identifier of the rule."
        },
        "rule_type": {
          "$ref": "#/definitions/RuleEvaluationRuleType",
          "title": "Type of the rule.\n@EXAMPLE MONITOR"
        },
        "detected_at": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the rule evaluation issues are detected.\nRule evaluations issues are aggregated over last 5 minute leading up to detected_at."
        },
        "count": {
          "type": "integer",
          "format": "int32",
          "description": "The number of rule evaluation issues occurred over last 5 minutes."
        },
        "message": {
          "type": "string",
          "description": "Detailed message related to rule evaluation issue. See \"Admin \u003e Evaluation failures\" in the Chronosphere documentation for more information."
        }
      }
    }
  }
}
